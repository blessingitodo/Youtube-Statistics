CREATE TABLE videos_stats (
(x1...> id INTEGER PRIMARY KEY, title TEXT, video_id TEXT, published_at DATE, keyword TEXT, likes INTEGER, no_comments INTEGER, views INTEGER);

 CREATE TABLE comments (
(x1...> id INTEGER PRIMARY KEY, video_id TEXT, comment TEXT, likes INTEGER, sentiment INTEGER);

.tables 

.mode csv
.import -skip 1 C:\Users\itodo\Downloads\comments.csv commen
ts
 .import -skip 1 C:\Users\itodo\Downloads\videos_stats.csv videos_stats

 SELECT title, video_id, MAX (no_comments) AS max_comments FROM videos_stats
   ...> ORDER BY max_comments;
SELECT title, video_id, MAX (likes) AS max_likes FROM videos_stats;


SELECT keyword, SUM (views) FROM videos_stats
   ...> GROUP BY keyword;

 SELECT keyword, SUM (likes) FROM videos_stats
   ...> GROUP BY keyword;

SELECT comment, MAX (likes) AS max_likes FROM comments
   ...> ORDER BY max_likes;

sqlite> SELECT keyword, views / likes AS ratio FROM videos_stats
   ...> LIMIT 10;
sqlite> SELECT keyword, SUM (views) / SUM (likes) AS ratio FROM videos_stats
   ...> GROUP BY keyword;


sqlite> SELECT videos_stats.keyword, AVG (comments.sentiment)
   ...> FROM comments
   ...> LEFT JOIN videos_stats
   ...> ON comments.video_id = videos_stats.video_id
   ...> GROUP BY videos_stats.keyword;

sqlite> SELECT keyword, COUNT (*) FROM videos_stats
   ...> WHERE title LIKE '%Apple%' OR title LIKE '%Samsung%'
   ...> GROUP BY keyword;


